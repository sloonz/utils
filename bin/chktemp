#!/bin/sh

get_temp() {
	cat /proc/acpi/thermal_zone/$1/temperature | awk '{print $2}'
}

while true ; do
	THRC=`get_temp THRC`
	THRS=`get_temp THRS`
	
	echo
	echo "THRC: $THRC"
	echo "THRS: $THRS"
	
	if [ $THRC -ge 90 -o $THRS -ge 60 ] ; then
		echo "Critical point reached !"
		echo "sleeping for 20 minutes"
		cpufreq-set -g powersave
		sleep 20m
		echo "restarting"
		cpufreq-set -g ondemand
	fi
	
	sleep 5
done
